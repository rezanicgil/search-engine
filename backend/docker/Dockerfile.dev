# Dockerfile.dev - Development Dockerfile with hot-reload support
# This is used for development with volume mounts and hot-reload

FROM golang:1.24-alpine

# Install build dependencies and Air (hot-reload tool)
# Using Air v1.51.0 which is compatible with Go 1.23
RUN apk update && \
    apk upgrade --no-cache && \
    apk add --no-cache git ca-certificates wget && \
    go install github.com/cosmtrek/air@v1.51.0 && \
    rm -rf /var/cache/apk/*

# Add Go bin directory to PATH so air command is available
ENV PATH="${PATH}:/go/bin"

# Set working directory
WORKDIR /app

# Copy go mod files first (for better layer caching)
# Note: Source code will be mounted as volume, so we only copy dependency files
COPY go.mod go.sum ./
RUN go mod download

# Default command - Air will watch for changes and rebuild
# Air config (.air.toml) will be available via volume mount
# Air is installed in $GOPATH/bin (default: /go/bin)
# Use air command directly (should be in PATH after installation)
CMD ["air", "-c", ".air.toml"]

